<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用工评价</title>
    <link rel="stylesheet" href="../css/assess.css" type="text/css">
    <meta name="viewport" content="width=1004, user-scalable=0">
    <link rel="stylesheet" href="../css/tk.css" type="text/css">
    <script src="../js/Responsive_layout.js"></script>
</head>
<body>
    <div class="header">
        <div class="title">我要评价</div>
    </div>
    <div class="nav">
        <div class="navli receive border_line">收到的评价</div>
        <div class="navli postAssess">我发起的评价</div>
        <div class="navli protect">法律维权</div>
    </div>
    <div class="receive_detail">
        <div class="main_content" id="receive">
            <div class="receive_list" v-for="(item,index) in receiveList">
                <div class="title">{{item.assess}}</div>
                <div class="emoji">
                    <img :src="receiveList[index].imgIco" alt="">
                </div>
                <div class="postMen">{{item.company}}</div>
                <div class="date">{{item.date}}</div>
            </div>
        </div>
        <div class="add"></div>
    </div>
    <div class="postAssess_detail">
        <div class="main_content" id="postAssess">
            <div class="post_list" v-for="(item,index) in postList">
                <div class="status">{{item.status}}</div>
                <div class="company">{{item.company}}</div>
                <audio :src="item.audioUrl" :id=index></audio>
                <div class="play playAudio" @click="playMusic(index)"></div>
                <div class="imgList">
                    <div class="img" v-for="(it) in item.img">
                        <img :src="it" alt="#">
                    </div>
                </div>
                <div class="data">{{item.date}}</div>
            </div>
        </div>
    </div>
    <!--添加评论-->
    <div class="addAssess">
        <div class="form_content">
            <form action="javascript:void (0)" method="post">
                <div class="int">
                    <div class="title">
                        <i></i>
                        选择施工总包
                    </div>
                    <label for="place">
                        <select id="place">
                            <option value="rank1">广东建粤一期工程有限公司</option>
                            <option value="rank1">广东建粤二期工程有限公司</option>
                            <option value="rank1">广东建粤三期工程有限公司</option>
                            <option value="rank1">广东建粤四期工程有限公司</option>
                        </select>
                    </label>
                </div>
                <div class="int">
                    <div class="int">
                        <div class="title">
                            <i></i>
                            评级内容
                        </div>
                        <div class="radio">
                            <div class="circle">
                                <div class="small active"></div>
                            </div>
                            <label for="nice">
                                <input type="radio" name="assess" id="nice" value="nice" hidden="hidden" checked="checked">优秀
                            </label>
                            <div class="circle">
                                <div class="small"></div>
                            </div>
                            <label for="normal">
                                <input type="radio" name="assess" id="normal" value="normal" hidden="hidden">良好
                            </label>
                            <div class="circle">
                                <div class="small"></div>
                            </div>
                            <label for="bad">
                                <input type="radio" name="assess" id="bad" value="bad" hidden="hidden">差评
                            </label>
                        </div>
                    </div>
                </div>
                <div class="int">
                    <div class="title">
                        <i></i>
                        评价内容
                    </div>
                    <div class="main_content">
                        <label for="assess" class="assess">
                            <textarea id="assess">伙食很好，班组长对我很好，经常请我抽中华烟，贼鸡儿...</textarea>
                        </label>
                        <div class="ico_photo"></div>
                        <div class="ico_mk"></div>
                    </div>
                    <div class="media">
                        <div class="newAudio">
                            新的录音三十秒
                            <div class="close"></div>
                        </div>
                        <div class="imglist">
                            <div class="imgAfter">
                                <div class="close"></div>
                                <img src="../images/sample_img_03.png" alt="#">
                            </div>
                            <div class="imgAfter">
                                <div class="close"></div>
                                <img src="../images/sample_img_03.png" alt="#">
                            </div>
                            <div class="addImg"></div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="submitBtn">
            <div class="right"></div>
        </div>
    </div>
    <div class="protect_detail">
        <div class="main_content" id="protect">
            <div class="mainMessage">{{message}}</div>
            <div class="btn" @click="tkAlter(msg)">一键咨询</div>
        </div>
    </div>
    <div class="footer">
        <div class="index">
            <div class="index_pic"></div>
            首页
        </div>
        <div class="resume">
            <div class="resume_pic"></div>
            工作履历
        </div>
        <div class="assess">
            <div class="assess_pic"></div>
            用工评价
        </div>
        <div class="userInfo">
            <div class="userInfo_pic"></div>
            我的
        </div>
    </div>
    <script src="../js/vue.js"></script>
    <script src="../js/assess.js" type="text/javascript"></script>
    <script src="../js/jQuery.js"></script>
    <script>
        //
        const receive = new Vue({
            el:'#receive',
            data:{
                receiveList:[
                    {
                        assess:'干活不认真',
                        company:'广东建粤工程有限公司',
                        imgIco:'aaaa',
                        date:'2017-10-11',
                    },
                    {
                        assess:'私生活不检点',
                        company:'广东建粤工程有限公司',
                        imgIco:'bbbb',
                        date:'2017-10-11',
                    },{
                        assess:'态度棒棒的',
                        company:'广东建粤工程有限公司',
                        imgIco:'cccc',
                        date:'2017-10-11',
                    },{
                        assess:'态度还不错',
                        company:'广东建粤工程有限公司',
                        imgIco:'dddd',
                        date:'2017-10-11',
                    },
                ]
            }
        });
        const postMen = new Vue({
            el:'#postAssess',
            data:{
                postList:[
                    {
                        status:'饭不好吃',
                        company:'广东建粤工程有限公司',
                        img: ['aaa','bbb'],
                        audioUrl:'aaaaa',
                        date:'2018-4-20  17：10',
                    },
                    {
                        status:'今天的饭菜很好吃',
                        company:'广东建粤工程有限公司',
                        img: ['aa','cc'],
                        audioUrl:'bbbbb',
                        date:'2018-4-20  17：10',
                    }
                ],
                current:0,
            },
            methods: {
                playMusic(index){
                    this.current = index;
                    console.log('播放当前音乐'+this.current);
                }
            }
        });
        const protectLaw = new Vue({
            el:'#protect',
            data:{
                message:'如果您需要帮助如拖欠工资款,工伤赔付,安全保险...请联系我们,我们会为您竭尽全力!!!',
                msg :{
                    title:'请问是否拨打求助电话',
                    content:'400 830 8339',
                    cancel:'取消',
                    confirm:'呼叫',
                    confirmFn:function(){
                        const body = document.querySelector('body');
                        const zhezhao = document.querySelector('.zhezhao');
                        body.removeChild(zhezhao);
                    },
                    cancelFn:function () {
                        const body = document.querySelector('body');
                        const zhezhao = document.querySelector('.zhezhao');
                        document.body.removeChild(zhezhao);
                    }
                }
            },
            methods: {
                tkAlter(ags){
                    var btn = document.querySelector('button');
                    var body = document.querySelector('body');
                    var zhezhao = document.createElement('div');
                    zhezhao.className = 'zhezhao';
                    zhezhao.innerHTML = `<div class="alert">
                    <div class="header">
                    <span class="title">`+ags.content+`</span>
                    </div>
                    <div class="btnList">
                    <div class="btn">`+ags.cancel+`</div>
                    <div class="btn">`+ags.confirm+`</div>
                    </div>
                    </div>`;
                    body.appendChild(zhezhao);

                    //在里面创建
                    //var close = document.querySelector('.alert .header .close');
                    //console.log(document.querySelector('.alert .header .close'));
                    /*close.onclick = function(){
                        body.removeChild(zhezhao);
                    };*/
                    var trueBtn = document.querySelectorAll('.btnList .btn')[0];
                    trueBtn.onclick = function(){
                        typeof ags.confirmFn() == "function"?ags.confirmFn():console.log('error');
                        body.removeChild(zhezhao);
                    };
                    var falseBtn = document.querySelectorAll('.btnList .btn')[1];
                    falseBtn.onclick = function(){
                        typeof ags.cancelFn() == 'function'?ags.cancelFn():console.log('error');
                        body.removeChild(zhezhao);
                    }
                }
            }
        });
        //等待所有DOM元素加载完毕之后
        const jj = $.noConflict();
        jj(document).ready(function () {
            //跳回主页
            jj('.footer .index').click(function () {
                location.href="../index.html"
            });
            //工作履历
            jj('.footer .resume').click(function () {
                location.href = "../other_html/resume.html"
            });
            //个人中心
            jj('.footer .userInfo').click(function () {
                location.href = '../other_html/userInfo.html'
            });

            //添加评论事件
            jj('.receive_detail .add').click(function () {
                jj(this).parent().hide();
                jj('.nav').hide();
                jj('.addAssess').show();
            });

            //添加单选事件
            jj('.circle .small').eq(0).click(function () {
                jj('#nice').attr('checked',true);
                jj('#normal').attr('checked',false);
                jj('#bad').attr('checked',false);
                jj(this).addClass('active').parent().siblings()
                    .children(".small").removeClass("active")
            }).end().eq(1).click(function () {
                jj('#nice').attr('checked',false);
                jj('#normal').attr('checked',true);
                jj('#bad').attr('checked',false);
                jj(this).addClass('active').parent().siblings()
                    .children(".small").removeClass("active")
            }).end().eq(2).click(function () {
                jj('#nice').attr('checked',false);
                jj('#normal').attr('checked',false);
                jj('#bad').attr('checked',true);
                jj(this).addClass('active').parent().siblings()
                    .children(".small").removeClass("active")
            });
            //label的绑定
            jj('.radio label').eq(0).click(function () {
                jj(this).prev().children(".small").addClass("active").end().siblings().children(".small").removeClass("active")
            }).end().eq(1).click(function () {
                jj(this).prev().children(".small").addClass("active").end().siblings().children(".small").removeClass("active")
            }).end().eq(2).click(function () {
                jj(this).prev().children(".small").addClass("active").end().siblings().children(".small").removeClass("active")
            });

            //添加提交事件
            let $isSubmit = false;
            jj('#assess').blur(function () {
                if (jj(this).val().length == 0) {

                    $isSubmit = false;
                    jj('.submitBtn').children('div').eq(0).removeClass('right');
                }else {
                    jj('.submitBtn').append('<div class="right">');
                    $isSubmit = true;
                }
            });
            jj('.submitBtn').click(function (e) {
                e.preventDefault();
                if ($isSubmit || jj('#assess').val().length != 0) {
                    jj('.addAssess').hide();
                    jj('.nav').show();
                    for (let i = 0; i < jj('.nav .navli').length; i++) {
                        jj('.nav .navli').eq(i).removeClass('border_line').end().eq(1).addClass('border_line');
                    }
                    jj('.postAssess_detail').show();
                    window.scrollTo(0,0)
                }
            });

            //删除录音
            jj('.newAudio .close').click(function () {
                jj(this).parent().slideUp(400);
            });

            //删除照片
            for (let i = 0; i < jj('.imgAfter').length; i++) {
                jj('.imgAfter .close').eq(i).click(function (e) {
                    jj(this).parent().hide();
                })
            }

            //添加照片事件
            jj('.addImg').click(function () {
                console.log('添加一张照片');
            });

            //设置拍照事件
            jj('.ico_photo').click(function () {
                console.log('现在开始拍照');
            });
            //设置录音事件
            jj('.ico_mk').click(function () {
                console.log('现在开始录音');
            });

        });

    </script>
</body>
</html>